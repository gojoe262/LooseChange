<html>
    <head>
        <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
        <!--Javascript Files-->
        <script type="text/javascript" src="js/shared/jquery/jquery-2.1.4.js"></script>
        <script type="text/javascript" src="js/shared/data-access/gJsonCacher.js"></script>
        <script type="text/javascript" src="https://apis.google.com/js/client.js"></script>
        <script type="text/javascript" src="https://apis.google.com/js/api.js"></script>

        <!--Javascript Inline-->
        <script type="text/javascript">
            $(document).ready(function() {

                var jsonCacher = new gJsonCacher();
                jsonCacher.authorize().done(function () {
                    $('#buttons').show();
                });

                $('#logText').val('');

                var categories = {
                    categories: [
                        {
                            name: "Electronics",
                            id: "M7QXzfVCXYYxMVm7zETUw5P8u2aXXH"
                        },
                        {
                            name: "Gas/Travel ",
                            id: "UUBrzuaIGxstACf2CshoJDUORO2fBq"
                        }
                    ]
                };

                var transactions = {
                    transactions: [
                        {
                            amount: 18.71,
                            categoryId: "9TCH3YOVBcD5RxCJFrLyIZxuhJDHY9",
                            comment: "McDons",
                            date: "20150109",
                            id: "6VDHBs6wyKhmp61JKsX0tmgj9klifr",
                            transactionType: "IN"
                        },
                        {
                            amount: 40.22,
                            categoryId: "9TCH3YOVBcD5RxCJFrLyIZxuhJDHY9",
                            comment: "McDons",
                            date: "20150109",
                            id: "6VDHBs6wyKhmp61JKsX0tmgj9klifr",
                            transactionType: "IN"
                        }
                    ]
                };

                //List objects
                $('#btnListObjects').click(function(){
                    jsonCacher.getObjectList()
                    .done(function (objectList) {
                        if(objectList.length !== 0){
                            $.each(objectList, function(index, value){
                                var object = value;
                                logMessage(index + '. ' + object.title);
                            });
                        } else {
                            logMessage('Nothing found');
                        }
                    });
                });

                //Insert Objects
                $('#btnUploadObjectCategories').click(function(){
                    jsonCacher.insertObject('Categories', categories)
                    .done(function(objName){
                        logMessage('Succesfully inserted ' + objName + ' object');
                    })
                    .fail(function (errText) {
                        logMessage(errText);
                    });
                });

                $('#btnUploadObjectTransactions').click(function(){
                    jsonCacher.insertObject('Transactions', transactions)
                    .done(function(objName){
                        logMessage('Succesfully inserted ' + objName + ' object');
                    })
                    .fail(function (errText) {
                        logMessage(errText);
                    });
                });

                //Get Objects
                $('#btnGetObject').click(function(){
                    var objectNameInput = $('#objectNameTextbox').val();
                    jsonCacher.getObject(objectNameInput)
                    .done(function(objectName, object){
                        logMessage('Successfully downloaded object ' + objectName + '\n '
                            + JSON.stringify(object));
                    }).fail(function(errText){
                        logMessage(errText);
                    });
                });

                //Delete Objects
                $('#btnDeleteObject').click(function(){
                    jsonCacher.deleteObject($('#objectNameTextbox').val())
                    .done(function(objName){
                        logMessage('Successfully delete object ' + objName);
                    })
                    .fail(function(errText){
                        logMessage(errText);
                    });
                });

                function logMessage(message){
                    $('#logText').val($('#logText').val() + '\n\n' + message);
                    $('#logText').scrollTop($('#logText')[0].scrollHeight);
                }

            });
        </script>
    </head>
    <body>
        <div id='buttons' style="display: none;">
            <button id="btnListObjects">List Objects</button>
            <br/>
            <button id="btnUploadObjectCategories">Upload Object Categories</button>
            <button id="btnUploadObjectTransactions">Upload Object Transactions</button>
            <br/>
            <button id="btnGetObject">Get Object</button>
            <button id="btnDeleteObject">Delete Object</button>
            <br/>
            <input id="objectNameTextbox" type="text"/>
            <br/>
        </div>
        <div id='textarea'>
            <textarea id="logText" style="width: 95%; height: 75%"></textarea>
        </div>
    </body>
</html>
